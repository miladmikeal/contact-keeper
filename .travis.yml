language: node_js
node_js:
  - 10.8
addons:
  apt:
    packages:
      - libgconf-2-4
cache:
  directories:
    - '~/.npm'
    - '~/.cache'
  override:
    - npm ci
    - npm run cy:verify
    - npm run cy:info
before-install:
  - cd client && npm i && cd ..
install:
  - npm i
script:
  - npm run dev & wait-on http://localhost:3000
  - npm run cy:run
  - kill $(jobs -p) || true
deploy:
  provider: heroku
  app: mikeal-contact-keeper
  api_key:
    secure: UHHNqjzuit81zawoASc8Z8buliVxQJlwFRCoX5kRL52WwjaXX24j8tcJGa5Wy0hIPaJUDmis5UN2AGcJqExajBI6qQAxmqpKu7XLAnrFNDChGHdRvDeiE4vMnFlq+WOY3s8xwrcL7n/s93kMFuG+cM2d8SAQxpP0x120zBiZzBkNpJIO+YgVX0r8lg4IeBGSErjTwrT/PStACSiH3zXCVjP3JeqDaFoa2MZzcsAbSehGr7RErFeITChVLadbTwvFfVHKm4YJ0d9F1Zu4x9wNscBgXmNsvbFENg1HXZUjTk3VFmjclajeIx0X282itM9E7hijU5TWmK1hPNo72rcxFFrIUwSInpKmAen4ppw+sehh4NHR5367GHMuyGjglhA7kyvb+HabCP0QIC8NgUeHPUoXmUlqUTzhlSWmKxcy/a7O6hexvbBhV7KfYvyhuNFinzUXhy1c43H44JTHXeedUDblcLNnCHZzMizVog09cmtLvLC03k1/CPhHSGKXgEdnUMTGYeHsNHrTpM8DpgqJb8U1k5nX51EeMefe7z6zE7Zm0bxHCRLYlalnyZS8chI1sHFpjcnPByi9+GwUv4JyMz5VSPuT225C6zov/29XuF8IocFlAn9mEp3wd6ghMsC0dKOK+dnyqn3HLb7AMZSRLrtOVIB+fefWnkonW7px5VY=
